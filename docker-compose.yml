version: "3.9"
services:
  jaeger:
    image: jaegertracing/all-in-one:1.53
    ports: ["16686:16686", "14268:14268"]
  prometheus:
    image: prom/prometheus:latest
    volumes:
      - ./monitoring/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml:ro
      - ./monitoring/prometheus/alerts.yml:/etc/prometheus/alerts.yml:ro
    ports: ["9090:9090"]
  grafana:
    image: grafana/grafana:latest
    ports: ["3000:3000"]
    volumes:
      - ./monitoring/grafana/dashboards:/var/lib/grafana/dashboards:ro
  bootstrap:
    build:
      context: .
      dockerfile: Dockerfile.bootstrap
    ports: ["8082:8082"]
  relay:
    build:
      context: .
      dockerfile: Dockerfile.relay
    ports: ["4433:4433", "8083:8083"]
  recv:
    build:
      context: .
      dockerfile: Dockerfile.quic_recv
    volumes:
      - recvdata:/data
    ports: ["4434:4433"]
volumes:
  recvdata:
